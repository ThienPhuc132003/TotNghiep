<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test GET with Body Data like Postman</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .test-section {
        margin: 20px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #007bff;
      }
      button {
        background: #007bff;
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 6px;
        cursor: pointer;
        margin: 10px 5px;
        font-size: 14px;
      }
      button:hover {
        background: #0056b3;
      }
      .success {
        background: #28a745;
      }
      .success:hover {
        background: #218838;
      }
      .danger {
        background: #dc3545;
      }
      .danger:hover {
        background: #c82333;
      }
      .warning {
        background: #ffc107;
        color: #212529;
      }
      .warning:hover {
        background: #e0a800;
      }

      .alert {
        padding: 15px;
        border-radius: 6px;
        margin: 15px 0;
      }
      .alert-warning {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        color: #856404;
      }
      .alert-info {
        background: #d1ecf1;
        border: 1px solid #bee5eb;
        color: #0c5460;
      }
      .alert-success {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
      }
      .alert-danger {
        background: #f8d7da;
        border: 1px solid #f5c6cb;
        color: #721c24;
      }
      pre {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 6px;
        overflow-x: auto;
        border: 1px solid #e9ecef;
        max-height: 300px;
      }
      .code-block {
        background: #2d3748;
        color: #e2e8f0;
        padding: 15px;
        border-radius: 6px;
        margin: 10px 0;
        font-family: "Courier New", monospace;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üß™ Test GET with Body Data - Like Postman</h1>
      <p>
        Test ƒë·ªÉ m√¥ ph·ªèng ch√≠nh x√°c c√°ch Postman g·ª≠i GET request v·ªõi body data
      </p>

      <div class="alert alert-info">
        <strong>üìã Test n√†y s·∫Ω:</strong>
        <ul>
          <li>G·ª≠i GET request v·ªõi body data gi·ªëng nh∆∞ Postman</li>
          <li>Test v·ªõi axios tr·ª±c ti·∫øp</li>
          <li>Test v·ªõi Api function c·ªßa app</li>
          <li>Ki·ªÉm tra xem request c√≥ ƒë∆∞·ª£c g·ª≠i ƒë√∫ng hay kh√¥ng</li>
          <li>Debug t·∫°i sao backend b√°o missing classroomId</li>
        </ul>
      </div>

      <div class="alert alert-warning">
        <strong>‚ö†Ô∏è H∆∞·ªõng d·∫´n:</strong>
        <ol>
          <li>M·ªü DevTools Console (F12)</li>
          <li>ƒê·∫£m b·∫£o main app ƒë√£ load (ƒë·ªÉ c√≥ Api function v√† apiLogger)</li>
          <li>Click c√°c n√∫t test ƒë·ªÉ ki·ªÉm tra</li>
          <li>Ki·ªÉm tra Network tab ƒë·ªÉ xem request th·ª±c t·∫ø</li>
        </ol>
      </div>

      <div class="test-section">
        <h3>üîß Test 1: Direct Axios GET with Body</h3>
        <p>Test tr·ª±c ti·∫øp v·ªõi axios ƒë·ªÉ m√¥ ph·ªèng Postman</p>
        <button onclick="testDirectAxiosGetWithBody()" class="success">
          Test Direct Axios
        </button>
        <pre id="axios-result">Ch∆∞a test...</pre>
      </div>

      <div class="test-section">
        <h3>üéØ Test 2: Api Function GET with Body</h3>
        <p>Test v·ªõi Api function t·ª´ app (nh∆∞ code th·ª±c t·∫ø)</p>
        <button onclick="testApiFunctionGetWithBody()" class="warning">
          Test Api Function
        </button>
        <pre id="api-function-result">Ch∆∞a test...</pre>
      </div>

      <div class="test-section">
        <h3>üîç Test 3: Network Inspector</h3>
        <p>Ki·ªÉm tra request actual trong Network tab</p>
        <button onclick="testAndInspectNetwork()" class="danger">
          Test & Inspect Network
        </button>
        <pre id="network-result">Ch∆∞a test...</pre>
      </div>

      <div class="test-section">
        <h3>üìä Test Results Summary</h3>
        <div id="test-summary">
          <div class="alert alert-info">Ch∆∞a c√≥ k·∫øt qu·∫£ test n√†o...</div>
        </div>
      </div>

      <div class="test-section">
        <h3>üõ†Ô∏è Debug Commands</h3>
        <p>Copy paste v√†o Console ƒë·ªÉ debug manual:</p>
        <div class="code-block">
          // 1. Test axios tr·ª±c ti·∫øp const testAxios = async () => { try { const
          response = await
          axios.get('https://giasuvu.click/api/meeting/get-meeting', { data: {
          classroomId: 'ad27f835-83e7-488f-b2ab-d932458afc95' }, headers: {
          'Content-Type': 'application/json', 'Authorization': 'Bearer
          YOUR_TOKEN' } }); console.log('‚úÖ Success:', response.data); } catch
          (error) { console.log('‚ùå Error:', error.response?.data ||
          error.message); } }; // 2. Test Api function const testApiFunction =
          async () => { if (typeof Api !== 'undefined') { try { const response =
          await Api({ endpoint: 'meeting/get-meeting', method: 'GET', data: {
          classroomId: 'ad27f835-83e7-488f-b2ab-d932458afc95' }, requireToken:
          true }); console.log('‚úÖ Api Function Success:', response); } catch
          (error) { console.log('‚ùå Api Function Error:', error); } } }; // 3.
          Ki·ªÉm tra axios config const checkAxiosConfig = () => { const config =
          { method: 'GET', url: 'test', data: { test: 'data' }, headers: {
          'Content-Type': 'application/json' } }; console.log('Config:',
          config); console.log('Axios supports GET with data:', !!config.data);
          };
        </div>
      </div>
    </div>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      let testResults = [];

      function addResult(test, status, message, details = null) {
        testResults.push({
          test,
          status,
          message,
          details,
          time: new Date().toLocaleTimeString(),
        });
        updateResultsDisplay();
      }

      function updateResultsDisplay() {
        const summaryDiv = document.getElementById("test-summary");
        const html = testResults
          .map((result) => {
            const alertClass =
              result.status === "success"
                ? "alert-success"
                : result.status === "warning"
                ? "alert-warning"
                : "alert-danger";
            let detailsHtml = "";
            if (result.details) {
              detailsHtml = `<pre style="margin-top: 10px; font-size: 12px;">${JSON.stringify(
                result.details,
                null,
                2
              )}</pre>`;
            }
            return `
                    <div class="alert ${alertClass}">
                        <strong>[${result.time}] ${result.test}:</strong> ${result.message}
                        ${detailsHtml}
                    </div>
                `;
          })
          .join("");
        summaryDiv.innerHTML =
          html ||
          '<div class="alert alert-info">Ch∆∞a c√≥ k·∫øt qu·∫£ test n√†o...</div>';
      }

      async function testDirectAxiosGetWithBody() {
        console.log("üß™ Testing Direct Axios GET with Body...");

        const testData = {
          classroomId: "ad27f835-83e7-488f-b2ab-d932458afc95", // From Postman image
        };

        try {
          console.log("üì§ Sending GET request with body:", testData);

          // M√¥ ph·ªèng ch√≠nh x√°c nh∆∞ Postman
          const response = await axios({
            method: "GET",
            url: "https://giasuvu.click/api/meeting/get-meeting",
            data: testData,
            headers: {
              "Content-Type": "application/json",
              Authorization: "Bearer YOUR_TOKEN_HERE", // Thay b·∫±ng token th·∫≠t
            },
          });

          console.log("‚úÖ Direct Axios Success:", response.data);
          document.getElementById(
            "axios-result"
          ).textContent = `‚úÖ Success!\nStatus: ${
            response.status
          }\nData: ${JSON.stringify(response.data, null, 2)}`;

          addResult(
            "Direct Axios",
            "success",
            `Status ${response.status} - Got ${
              response.data?.data?.result?.items?.length || 0
            } meetings`,
            response.data
          );
        } catch (error) {
          console.error("‚ùå Direct Axios Error:", error);
          const errorMsg = error.response?.data?.message || error.message;
          const errorStatus = error.response?.status || "Network Error";

          document.getElementById(
            "axios-result"
          ).textContent = `‚ùå Error!\nStatus: ${errorStatus}\nError: ${errorMsg}\nDetails: ${JSON.stringify(
            error.response?.data || error.message,
            null,
            2
          )}`;

          addResult(
            "Direct Axios",
            "error",
            `Status ${errorStatus} - ${errorMsg}`,
            error.response?.data
          );
        }
      }

      async function testApiFunctionGetWithBody() {
        console.log("üß™ Testing Api Function GET with Body...");

        if (typeof Api === "undefined") {
          const errorMsg = "Api function not found. Load main app first!";
          console.log("‚ùå", errorMsg);
          document.getElementById(
            "api-function-result"
          ).textContent = `‚ùå ${errorMsg}`;
          addResult("Api Function", "error", errorMsg);
          return;
        }

        const testData = {
          classroomId: "ad27f835-83e7-488f-b2ab-d932458afc95",
        };

        try {
          console.log("üì§ Using Api function with data:", testData);

          const response = await Api({
            endpoint: "meeting/get-meeting",
            method: "GET",
            data: testData,
            requireToken: true,
          });

          console.log("‚úÖ Api Function Success:", response);
          document.getElementById(
            "api-function-result"
          ).textContent = `‚úÖ Success!\nResponse: ${JSON.stringify(
            response,
            null,
            2
          )}`;

          addResult(
            "Api Function",
            "success",
            `Got ${response?.data?.result?.items?.length || 0} meetings`,
            response
          );
        } catch (error) {
          console.error("‚ùå Api Function Error:", error);
          const errorMsg = error.response?.data?.message || error.message;

          document.getElementById(
            "api-function-result"
          ).textContent = `‚ùå Error!\nError: ${errorMsg}\nDetails: ${JSON.stringify(
            error.response?.data || error.message,
            null,
            2
          )}`;

          addResult("Api Function", "error", errorMsg, error.response?.data);
        }
      }

      async function testAndInspectNetwork() {
        console.log("üîç Testing with Network Inspector...");
        console.log(
          "üëÄ Open Network tab in DevTools to see the actual request!"
        );

        // Enable API logging n·∫øu c√≥
        if (typeof enableAPILogging === "function") {
          enableAPILogging();
        }

        const testData = {
          classroomId: "ad27f835-83e7-488f-b2ab-d932458afc95",
        };

        try {
          console.log("üì° Sending request - check Network tab for details...");

          // Test v·ªõi c·∫£ hai c√°ch
          console.group("üîó Testing both methods:");

          // Method 1: Direct axios
          console.log("1Ô∏è‚É£ Direct Axios Request...");
          const axiosPromise = axios.get("https://httpbin.org/anything", {
            data: testData,
            headers: { "Content-Type": "application/json" },
          });

          // Method 2: Api function (n·∫øu c√≥)
          let apiPromise = null;
          if (typeof Api !== "undefined") {
            console.log("2Ô∏è‚É£ Api Function Request...");
            apiPromise = Api({
              endpoint: "meeting/get-meeting",
              method: "GET",
              data: testData,
              requireToken: true,
            });
          }

          // Wait for both
          const results = await Promise.allSettled(
            [axiosPromise, apiPromise].filter(Boolean)
          );

          console.log("üìä Results:", results);
          console.groupEnd();

          document.getElementById("network-result").textContent =
            `‚úÖ Network test completed! Check DevTools Network tab for request details.\n` +
            `Results: ${results.length} requests sent\n` +
            `Check console for detailed logs.`;

          addResult(
            "Network Inspector",
            "success",
            `Sent ${results.length} requests - check Network tab`
          );
        } catch (error) {
          console.error("‚ùå Network test error:", error);
          document.getElementById(
            "network-result"
          ).textContent = `‚ùå Network test failed: ${error.message}`;

          addResult("Network Inspector", "error", error.message);
        }
      }

      // Auto-run on load
      window.addEventListener("load", function () {
        console.log("üöÄ GET Body Test Page Loaded");
        console.log(
          "üìã This page tests GET requests with body data like Postman"
        );
        console.log("üîç Make sure to check Network tab when running tests");

        // Check for required functions
        const checks = {
          axios: typeof axios,
          Api: typeof Api,
          apiLogger: typeof window.apiLogger,
          enableAPILogging: typeof window.enableAPILogging,
        };

        console.table(checks);

        addResult(
          "Page Load",
          "success",
          "Test page loaded - ready to run tests"
        );
      });
    </script>
  </body>
</html>
