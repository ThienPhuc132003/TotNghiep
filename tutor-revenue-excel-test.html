<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Tutor Revenue Excel Export - Van Lang University</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .header {
        text-align: center;
        margin-bottom: 40px;
        padding-bottom: 20px;
        border-bottom: 2px solid #28a745;
      }
      .header h1 {
        color: #28a745;
        margin-bottom: 10px;
      }
      .test-section {
        margin: 30px 0;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #f9f9f9;
      }
      .test-section h2 {
        color: #333;
        margin-bottom: 15px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 10px;
      }
      .success {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
      }
      .feature {
        background-color: #e7f3ff;
        border: 1px solid #b3d9ff;
        padding: 15px;
        border-radius: 5px;
        margin: 15px 0;
      }
      .code {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 4px;
        padding: 10px;
        font-family: "Courier New", monospace;
        font-size: 14px;
        margin: 10px 0;
      }
      .step {
        counter-increment: step-counter;
        margin: 20px 0;
        padding: 15px;
        border-left: 4px solid #28a745;
        background-color: #f8f9fa;
      }
      .step::before {
        content: "‚úÖ ";
        font-weight: bold;
        color: #28a745;
        margin-right: 8px;
      }
      .comparison {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin: 20px 0;
      }
      .comparison > div {
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #ddd;
      }
      .old {
        background-color: #ffe6e6;
        border-color: #ffb3b3;
      }
      .new {
        background-color: #e6ffe6;
        border-color: #b3ffb3;
      }
      .keyboard-shortcut {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-family: monospace;
        font-weight: bold;
      }
      .excel-preview {
        background-color: #f0f8f0;
        border: 2px solid #28a745;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }
      .excel-preview h3 {
        color: #28a745;
        margin-bottom: 15px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üéì Test Ch·ª©c NƒÉng Excel Export - Trang Gia S∆∞</h1>
        <p>
          Ki·ªÉm tra xu·∫•t Excel v·ªõi logo Van Lang University cho trang th·ªëng k√™
          doanh thu gia s∆∞
        </p>
      </div>

      <div class="success">
        <strong>‚úÖ Ho√†n th√†nh n√¢ng c·∫•p:</strong> Trang TutorRevenueStable ƒë√£
        ƒë∆∞·ª£c t√≠ch h·ª£p ch·ª©c nƒÉng Excel export chuy√™n nghi·ªáp v·ªõi logo Van Lang
        University, gi·ªëng nh∆∞ c√°c trang admin!
      </div>

      <div class="test-section">
        <h2>üîÑ So S√°nh Tr∆∞·ªõc v√† Sau</h2>
        <div class="comparison">
          <div class="old">
            <h3>‚ùå Tr∆∞·ªõc ƒë√¢y (CSV Export)</h3>
            <ul>
              <li>Ch·ªâ xu·∫•t file CSV th√¥</li>
              <li>Kh√¥ng c√≥ logo tr∆∞·ªùng</li>
              <li>ƒê·ªãnh d·∫°ng ƒë∆°n gi·∫£n</li>
              <li>Thi·∫øu th√¥ng tin header</li>
              <li>Kh√¥ng c√≥ th·ªëng k√™ t√≥m t·∫Øt</li>
            </ul>
          </div>
          <div class="new">
            <h3>‚úÖ Hi·ªán t·∫°i (Excel Export)</h3>
            <ul>
              <li>Xu·∫•t file Excel (.xlsx) chuy√™n nghi·ªáp</li>
              <li>Logo Van Lang University (80x80px)</li>
              <li>Header v·ªõi t√™n tr∆∞·ªùng v√† khoa</li>
              <li>Ti√™u ƒë·ªÅ b√°o c√°o ƒë·ªông</li>
              <li>Th·ªëng k√™ t√≥m t·∫Øt v·ªõi m√†u n·ªÅn</li>
              <li>D·ªØ li·ªáu c√≥ vi·ªÅn v√† alternate colors</li>
              <li>Auto-sizing columns</li>
              <li>Footer v·ªõi ng√†y xu·∫•t</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="test-section">
        <h2>‚ö° T√≠nh NƒÉng M·ªõi</h2>

        <div class="feature">
          <h3>üéπ Keyboard Shortcuts</h3>
          <ul>
            <li>
              <span class="keyboard-shortcut">Ctrl + E</span> - Xu·∫•t Excel nhanh
            </li>
            <li>
              <span class="keyboard-shortcut">Ctrl + R</span> - L√†m m·ªõi d·ªØ li·ªáu
            </li>
            <li>
              <span class="keyboard-shortcut">Ctrl + F</span> - Focus v√†o √¥ t√¨m
              ki·∫øm
            </li>
          </ul>
        </div>

        <div class="feature">
          <h3>üé® UI/UX Improvements</h3>
          <ul>
            <li>Button xu·∫•t Excel c√≥ m√†u xanh l√° (admin style)</li>
            <li>Icon Excel chuy√™n nghi·ªáp</li>
            <li>Tooltip h∆∞·ªõng d·∫´n chi ti·∫øt</li>
            <li>Loading state v·ªõi toast notifications</li>
            <li>Error handling t·ªët h∆°n</li>
          </ul>
        </div>

        <div class="feature">
          <h3>üìä Data Quality</h3>
          <ul>
            <li>Th·ªëng k√™ t√≥m t·∫Øt: T·ªïng GD, Doanh thu, H·ªçc sinh, TB/GD</li>
            <li>ƒê·ªãnh d·∫°ng s·ªë theo chu·∫©n Vi·ªát Nam</li>
            <li>Ng√†y th√°ng hi·ªÉn th·ªã ƒë√∫ng m√∫i gi·ªù</li>
            <li>X·ª≠ l√Ω d·ªØ li·ªáu r·ªóng an to√†n</li>
          </ul>
        </div>
      </div>

      <div class="excel-preview">
        <h3>üìã C·∫•u Tr√∫c File Excel Xu·∫•t Ra</h3>
        <div class="code">
          <strong>C·∫•u tr√∫c file Excel:</strong>
          [A1] üéì Logo Van Lang University (80x80px) [B1] TR∆Ø·ªúNG ƒê·∫†I H·ªåC VƒÇN
          LANG [B2] KHOA C√îNG NGH·ªÜ TH√îNG TIN [A4] TH·ªêNG K√ä DOANH THU GIA S∆Ø
          (Title) [A5] Th·ªùi gian: T·ªïng c·ªông: X giao d·ªãch [A7] === TH·ªêNG K√ä T√ìM
          T·∫ÆT === (Background m√†u) [A8-A11] T·ªïng s·ªë giao d·ªãch | T·ªïng doanh thu |
          S·ªë h·ªçc sinh | Doanh thu TB/GD [A13] === D·ªÆ LI·ªÜU CHI TI·∫æT === [A14] STT
          | T√™n h·ªçc sinh | ID h·ªçc sinh | Coin gia s∆∞ nh·∫≠n | Ng√†y t·∫°o [A15+]
          [Data rows v·ªõi vi·ªÅn v√† alternate colors] [Footer] TP.H·ªì Ch√≠ Minh, ng√†y
          XX th√°ng XX nƒÉm XXXX | Ng∆∞·ªùi l·∫≠p danh s√°ch
        </div>
      </div>

      <div class="test-section">
        <h2>üß™ H∆∞·ªõng D·∫´n Test</h2>

        <div class="step">
          <strong>ƒêƒÉng nh·∫≠p v·ªõi t√†i kho·∫£n gia s∆∞</strong>
          <div class="code">
            URL: http://localhost:3000/user/tutor-revenue-stable<br />
            Y√™u c·∫ßu: T√†i kho·∫£n c√≥ role TUTOR
          </div>
        </div>

        <div class="step">
          <strong>Ki·ªÉm tra giao di·ªán</strong>
          <ul>
            <li>Layout n·∫±m g·ªçn trong viewport (100vh)</li>
            <li>Header: "Th·ªëng k√™ Doanh thu" (kh√¥ng c√≥ d√≤ng ch√†o m·ª´ng)</li>
            <li>3 cards th·ªëng k√™ hi·ªán ƒë·∫°i</li>
            <li>Table v·ªõi controls t√¨m ki·∫øm v√† s·∫Øp x·∫øp</li>
            <li>Button xu·∫•t Excel m√†u xanh l√° v·ªõi icon</li>
          </ul>
        </div>

        <div class="step">
          <strong>Test ch·ª©c nƒÉng xu·∫•t Excel</strong>
          <ul>
            <li>
              Click n√∫t "Xu·∫•t Excel" ho·∫∑c nh·∫•n
              <span class="keyboard-shortcut">Ctrl + E</span>
            </li>
            <li>Ki·ªÉm tra toast notification "ƒêang t·∫°o file Excel..."</li>
            <li>
              File t·∫£i v·ªÅ v·ªõi t√™n: thong-ke-doanh-thu-gia-su-YYYY-MM-DD.xlsx
            </li>
            <li>M·ªü file Excel v√† ki·ªÉm tra c·∫•u tr√∫c nh∆∞ m√¥ t·∫£ ·ªü tr√™n</li>
          </ul>
        </div>

        <div class="step">
          <strong>Test keyboard shortcuts</strong>
          <ul>
            <li><span class="keyboard-shortcut">Ctrl + E</span>: Xu·∫•t Excel</li>
            <li>
              <span class="keyboard-shortcut">Ctrl + R</span>: L√†m m·ªõi data
            </li>
            <li>
              <span class="keyboard-shortcut">Ctrl + F</span>: Focus search
            </li>
          </ul>
        </div>

        <div class="step">
          <strong>Test v·ªõi d·ªØ li·ªáu kh√°c nhau</strong>
          <ul>
            <li>Test khi c√≥ d·ªØ li·ªáu: Ki·ªÉm tra th·ªëng k√™ t√≥m t·∫Øt</li>
            <li>Test khi kh√¥ng c√≥ d·ªØ li·ªáu: Ki·ªÉm tra warning message</li>
            <li>Test filter v√† search: Xu·∫•t d·ªØ li·ªáu ƒë√£ l·ªçc</li>
          </ul>
        </div>
      </div>

      <div class="test-section">
        <h2>üîß Technical Implementation</h2>

        <div class="code">
          <strong>Files ƒë√£ c·∫≠p nh·∫≠t:</strong>
          1. src/pages/User/TutorRevenueStable.jsx - ‚úÖ Import exportToExcel t·ª´
          utils/excelExport - ‚úÖ Implement function exportToExcel v·ªõi config ƒë·∫ßy
          ƒë·ªß - ‚úÖ Th√™m keyboard shortcuts (Ctrl+E, Ctrl+R, Ctrl+F) - ‚úÖ Update
          button tooltip v√† style 2.
          src/assets/css/User/ModernRevenueStatistics.style.css - ‚úÖ Button xu·∫•t
          Excel m√†u xanh l√° (#28a745) - ‚úÖ Hover effects v√† disabled states - ‚úÖ
          Consistent v·ªõi admin styling 3. src/utils/excelExport.js (ƒê√£ c√≥ s·∫µn) -
          ‚úÖ ExcelJS integration - ‚úÖ Logo Van Lang University embedding - ‚úÖ
          Professional formatting v√† styling
        </div>
      </div>

      <div class="test-section">
        <h2>üéØ API & Data Integration</h2>

        <div class="feature">
          <h3>‚úÖ API Endpoint</h3>
          <div class="code">
            GET manage-payment/search-with-time-by-tutor<br />
            Params: { tutorId: userProfile.id }
          </div>
        </div>

        <div class="feature">
          <h3>‚úÖ Data Processing</h3>
          <ul>
            <li>Transform API response th√†nh format ph√π h·ª£p</li>
            <li>Calculate summary statistics (total, average, count)</li>
            <li>Format currency theo chu·∫©n Vi·ªát Nam</li>
            <li>Handle nested properties safely</li>
          </ul>
        </div>
      </div>

      <div class="success">
        <h2>üéâ K·∫øt Lu·∫≠n</h2>
        <p>
          <strong>Trang TutorRevenueStable ƒë√£ ƒë∆∞·ª£c n√¢ng c·∫•p th√†nh c√¥ng!</strong>
        </p>
        <ul>
          <li>‚úÖ Giao di·ªán hi·ªán ƒë·∫°i, n·∫±m g·ªçn trong viewport</li>
          <li>‚úÖ API m·ªõi ƒë√£ ƒë∆∞·ª£c t√≠ch h·ª£p ƒë√∫ng</li>
          <li>‚úÖ Excel export chuy√™n nghi·ªáp v·ªõi logo Van Lang</li>
          <li>‚úÖ Keyboard shortcuts nh∆∞ admin pages</li>
          <li>‚úÖ UI/UX consistency v·ªõi h·ªá th·ªëng</li>
          <li>‚úÖ Code clean, error handling t·ªët</li>
        </ul>

        <p>
          Trang n√†y gi·ªù ƒë√¢y c√≥ ch·∫•t l∆∞·ª£ng t∆∞∆°ng ƒë∆∞∆°ng v·ªõi c√°c trang admin, cung
          c·∫•p tr·∫£i nghi·ªám xu·∫•t b√°o c√°o chuy√™n nghi·ªáp cho gia s∆∞! üöÄ
        </p>
      </div>
    </div>

    <script>
      console.log("üéì Tutor Revenue Excel Export Test Page Loaded");
      console.log("‚úÖ Features implemented:");
      console.log("   - Excel export with Van Lang logo");
      console.log("   - Keyboard shortcuts (Ctrl+E, Ctrl+R, Ctrl+F)");
      console.log("   - Professional formatting");
      console.log("   - Admin-style UI");
      console.log("   - Layout fits in viewport");

      // Auto test link after 3 seconds
      setTimeout(() => {
        if (
          confirm("B·∫°n c√≥ mu·ªën m·ªü trang TutorRevenueStable ƒë·ªÉ test ngay kh√¥ng?")
        ) {
          window.open(
            "http://localhost:3000/user/tutor-revenue-stable",
            "_blank"
          );
        }
      }, 3000);
    </script>
  </body>
</html>
