<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test Tutor Revenue Excel Export - Van Lang University</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .header {
        text-align: center;
        margin-bottom: 40px;
        padding-bottom: 20px;
        border-bottom: 2px solid #28a745;
      }
      .header h1 {
        color: #28a745;
        margin-bottom: 10px;
      }
      .test-section {
        margin: 30px 0;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #f9f9f9;
      }
      .test-section h2 {
        color: #333;
        margin-bottom: 15px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 10px;
      }
      .success {
        background-color: #d4edda;
        border: 1px solid #c3e6cb;
        color: #155724;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
      }
      .feature {
        background-color: #e7f3ff;
        border: 1px solid #b3d9ff;
        padding: 15px;
        border-radius: 5px;
        margin: 15px 0;
      }
      .code {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 4px;
        padding: 10px;
        font-family: "Courier New", monospace;
        font-size: 14px;
        margin: 10px 0;
      }
      .step {
        counter-increment: step-counter;
        margin: 20px 0;
        padding: 15px;
        border-left: 4px solid #28a745;
        background-color: #f8f9fa;
      }
      .step::before {
        content: "âœ… ";
        font-weight: bold;
        color: #28a745;
        margin-right: 8px;
      }
      .comparison {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin: 20px 0;
      }
      .comparison > div {
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #ddd;
      }
      .old {
        background-color: #ffe6e6;
        border-color: #ffb3b3;
      }
      .new {
        background-color: #e6ffe6;
        border-color: #b3ffb3;
      }
      .keyboard-shortcut {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-family: monospace;
        font-weight: bold;
      }
      .excel-preview {
        background-color: #f0f8f0;
        border: 2px solid #28a745;
        padding: 20px;
        border-radius: 8px;
        margin: 20px 0;
      }
      .excel-preview h3 {
        color: #28a745;
        margin-bottom: 15px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ğŸ“ Test Chá»©c NÄƒng Excel Export - Trang Gia SÆ°</h1>
        <p>
          Kiá»ƒm tra xuáº¥t Excel vá»›i logo Van Lang University cho trang thá»‘ng kÃª
          doanh thu gia sÆ°
        </p>
      </div>

      <div class="success">
        <strong>âœ… HoÃ n thÃ nh nÃ¢ng cáº¥p:</strong> Trang TutorRevenueStable Ä‘Ã£
        Ä‘Æ°á»£c tÃ­ch há»£p chá»©c nÄƒng Excel export chuyÃªn nghiá»‡p vá»›i logo Van Lang
        University, giá»‘ng nhÆ° cÃ¡c trang admin!
      </div>

      <div class="test-section">
        <h2>ğŸ”„ So SÃ¡nh TrÆ°á»›c vÃ  Sau</h2>
        <div class="comparison">
          <div class="old">
            <h3>âŒ TrÆ°á»›c Ä‘Ã¢y (CSV Export)</h3>
            <ul>
              <li>Chá»‰ xuáº¥t file CSV thÃ´</li>
              <li>KhÃ´ng cÃ³ logo trÆ°á»ng</li>
              <li>Äá»‹nh dáº¡ng Ä‘Æ¡n giáº£n</li>
              <li>Thiáº¿u thÃ´ng tin header</li>
              <li>KhÃ´ng cÃ³ thá»‘ng kÃª tÃ³m táº¯t</li>
            </ul>
          </div>
          <div class="new">
            <h3>âœ… Hiá»‡n táº¡i (Excel Export)</h3>
            <ul>
              <li>Xuáº¥t file Excel (.xlsx) chuyÃªn nghiá»‡p</li>
              <li>Logo Van Lang University (80x80px)</li>
              <li>Header vá»›i tÃªn trÆ°á»ng vÃ  khoa</li>
              <li>TiÃªu Ä‘á» bÃ¡o cÃ¡o Ä‘á»™ng</li>
              <li>Thá»‘ng kÃª tÃ³m táº¯t vá»›i mÃ u ná»n</li>
              <li>Dá»¯ liá»‡u cÃ³ viá»n vÃ  alternate colors</li>
              <li>Auto-sizing columns</li>
              <li>Footer vá»›i ngÃ y xuáº¥t</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="test-section">
        <h2>âš¡ TÃ­nh NÄƒng Má»›i</h2>

        <div class="feature">
          <h3>ğŸ¹ Keyboard Shortcuts</h3>
          <ul>
            <li>
              <span class="keyboard-shortcut">Ctrl + E</span> - Xuáº¥t Excel nhanh
            </li>
            <li>
              <span class="keyboard-shortcut">Ctrl + R</span> - LÃ m má»›i dá»¯ liá»‡u
            </li>
            <li>
              <span class="keyboard-shortcut">Ctrl + F</span> - Focus vÃ o Ã´ tÃ¬m
              kiáº¿m
            </li>
          </ul>
        </div>

        <div class="feature">
          <h3>ğŸ¨ UI/UX Improvements</h3>
          <ul>
            <li>Button xuáº¥t Excel cÃ³ mÃ u xanh lÃ¡ (admin style)</li>
            <li>Icon Excel chuyÃªn nghiá»‡p</li>
            <li>Tooltip hÆ°á»›ng dáº«n chi tiáº¿t</li>
            <li>Loading state vá»›i toast notifications</li>
            <li>Error handling tá»‘t hÆ¡n</li>
          </ul>
        </div>

        <div class="feature">
          <h3>ğŸ“Š Data Quality</h3>
          <ul>
            <li>Thá»‘ng kÃª tÃ³m táº¯t: Tá»•ng GD, Doanh thu, Há»c sinh, TB/GD</li>
            <li>Äá»‹nh dáº¡ng sá»‘ theo chuáº©n Viá»‡t Nam</li>
            <li>NgÃ y thÃ¡ng hiá»ƒn thá»‹ Ä‘Ãºng mÃºi giá»</li>
            <li>Xá»­ lÃ½ dá»¯ liá»‡u rá»—ng an toÃ n</li>
          </ul>
        </div>
      </div>

      <div class="excel-preview">
        <h3>ğŸ“‹ Cáº¥u TrÃºc File Excel Xuáº¥t Ra</h3>
        <div class="code">
          <strong>Cáº¥u trÃºc file Excel:</strong>
          [A1] ğŸ“ Logo Van Lang University (80x80px) [B1] TRÆ¯á»œNG Äáº I Há»ŒC VÄ‚N
          LANG [B2] KHOA CÃ”NG NGHá»† THÃ”NG TIN [A4] THá»NG KÃŠ DOANH THU GIA SÆ¯
          (Title) [A5] Thá»i gian: Tá»•ng cá»™ng: X giao dá»‹ch [A7] === THá»NG KÃŠ TÃ“M
          Táº®T === (Background mÃ u) [A8-A11] Tá»•ng sá»‘ giao dá»‹ch | Tá»•ng doanh thu |
          Sá»‘ há»c sinh | Doanh thu TB/GD [A13] === Dá»® LIá»†U CHI TIáº¾T === [A14] STT
          | TÃªn há»c sinh | ID há»c sinh | Coin gia sÆ° nháº­n | NgÃ y táº¡o [A15+]
          [Data rows vá»›i viá»n vÃ  alternate colors] [Footer] TP.Há»“ ChÃ­ Minh, ngÃ y
          XX thÃ¡ng XX nÄƒm XXXX | NgÆ°á»i láº­p danh sÃ¡ch
        </div>
      </div>

      <div class="test-section">
        <h2>ğŸ§ª HÆ°á»›ng Dáº«n Test</h2>

        <div class="step">
          <strong>ÄÄƒng nháº­p vá»›i tÃ i khoáº£n gia sÆ°</strong>
          <div class="code">
            URL: http://localhost:3000/user/tutor-revenue-stable<br />
            YÃªu cáº§u: TÃ i khoáº£n cÃ³ role TUTOR
          </div>
        </div>

        <div class="step">
          <strong>Kiá»ƒm tra giao diá»‡n</strong>
          <ul>
            <li>Layout náº±m gá»n trong viewport (100vh)</li>
            <li>Header: "Thá»‘ng kÃª Doanh thu" (khÃ´ng cÃ³ dÃ²ng chÃ o má»«ng)</li>
            <li>3 cards thá»‘ng kÃª hiá»‡n Ä‘áº¡i</li>
            <li>Table vá»›i controls tÃ¬m kiáº¿m vÃ  sáº¯p xáº¿p</li>
            <li>Button xuáº¥t Excel mÃ u xanh lÃ¡ vá»›i icon</li>
          </ul>
        </div>

        <div class="step">
          <strong>Test chá»©c nÄƒng xuáº¥t Excel</strong>
          <ul>
            <li>
              Click nÃºt "Xuáº¥t Excel" hoáº·c nháº¥n
              <span class="keyboard-shortcut">Ctrl + E</span>
            </li>
            <li>Kiá»ƒm tra toast notification "Äang táº¡o file Excel..."</li>
            <li>
              File táº£i vá» vá»›i tÃªn: thong-ke-doanh-thu-gia-su-YYYY-MM-DD.xlsx
            </li>
            <li>Má»Ÿ file Excel vÃ  kiá»ƒm tra cáº¥u trÃºc nhÆ° mÃ´ táº£ á»Ÿ trÃªn</li>
          </ul>
        </div>

        <div class="step">
          <strong>Test keyboard shortcuts</strong>
          <ul>
            <li><span class="keyboard-shortcut">Ctrl + E</span>: Xuáº¥t Excel</li>
            <li>
              <span class="keyboard-shortcut">Ctrl + R</span>: LÃ m má»›i data
            </li>
            <li>
              <span class="keyboard-shortcut">Ctrl + F</span>: Focus search
            </li>
          </ul>
        </div>

        <div class="step">
          <strong>Test vá»›i dá»¯ liá»‡u khÃ¡c nhau</strong>
          <ul>
            <li>Test khi cÃ³ dá»¯ liá»‡u: Kiá»ƒm tra thá»‘ng kÃª tÃ³m táº¯t</li>
            <li>Test khi khÃ´ng cÃ³ dá»¯ liá»‡u: Kiá»ƒm tra warning message</li>
            <li>Test filter vÃ  search: Xuáº¥t dá»¯ liá»‡u Ä‘Ã£ lá»c</li>
          </ul>
        </div>
      </div>

      <div class="test-section">
        <h2>ğŸ”§ Technical Implementation</h2>

        <div class="code">
          <strong>Files Ä‘Ã£ cáº­p nháº­t:</strong>
          1. src/pages/User/TutorRevenueStable.jsx - âœ… Import exportToExcel tá»«
          utils/excelExport - âœ… Implement function exportToExcel vá»›i config Ä‘áº§y
          Ä‘á»§ - âœ… ThÃªm keyboard shortcuts (Ctrl+E, Ctrl+R, Ctrl+F) - âœ… Update
          button tooltip vÃ  style 2.
          src/assets/css/User/ModernRevenueStatistics.style.css - âœ… Button xuáº¥t
          Excel mÃ u xanh lÃ¡ (#28a745) - âœ… Hover effects vÃ  disabled states - âœ…
          Consistent vá»›i admin styling 3. src/utils/excelExport.js (ÄÃ£ cÃ³ sáºµn) -
          âœ… ExcelJS integration - âœ… Logo Van Lang University embedding - âœ…
          Professional formatting vÃ  styling
        </div>
      </div>

      <div class="test-section">
        <h2>ğŸ¯ API & Data Integration</h2>

        <div class="feature">
          <h3>âœ… API Endpoint</h3>
          <div class="code">
            GET manage-payment/search-with-time-by-tutor<br />
            Params: { tutorId: userProfile.id }
          </div>
        </div>

        <div class="feature">
          <h3>âœ… Data Processing</h3>
          <ul>
            <li>Transform API response thÃ nh format phÃ¹ há»£p</li>
            <li>Calculate summary statistics (total, average, count)</li>
            <li>Format currency theo chuáº©n Viá»‡t Nam</li>
            <li>Handle nested properties safely</li>
          </ul>
        </div>
      </div>

      <div class="success">
        <h2>ğŸ‰ Káº¿t Luáº­n</h2>
        <p>
          <strong>Trang TutorRevenueStable Ä‘Ã£ Ä‘Æ°á»£c nÃ¢ng cáº¥p thÃ nh cÃ´ng!</strong>
        </p>
        <ul>
          <li>âœ… Giao diá»‡n hiá»‡n Ä‘áº¡i, náº±m gá»n trong viewport</li>
          <li>âœ… API má»›i Ä‘Ã£ Ä‘Æ°á»£c tÃ­ch há»£p Ä‘Ãºng</li>
          <li>âœ… Excel export chuyÃªn nghiá»‡p vá»›i logo Van Lang</li>
          <li>âœ… Keyboard shortcuts nhÆ° admin pages</li>
          <li>âœ… UI/UX consistency vá»›i há»‡ thá»‘ng</li>
          <li>âœ… Code clean, error handling tá»‘t</li>
        </ul>

        <p>
          Trang nÃ y giá» Ä‘Ã¢y cÃ³ cháº¥t lÆ°á»£ng tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i cÃ¡c trang admin, cung
          cáº¥p tráº£i nghiá»‡m xuáº¥t bÃ¡o cÃ¡o chuyÃªn nghiá»‡p cho gia sÆ°! ğŸš€
        </p>
      </div>
    </div>

    <script>
      console.log("ğŸ“ Tutor Revenue Excel Export Test Page Loaded");
      console.log("âœ… Features implemented:");
      console.log("   - Excel export with Van Lang logo");
      console.log("   - Keyboard shortcuts (Ctrl+E, Ctrl+R, Ctrl+F)");
      console.log("   - Professional formatting");
      console.log("   - Admin-style UI");
      console.log("   - Layout fits in viewport");

      // Auto test link after 3 seconds
      setTimeout(() => {
        if (
          confirm("Báº¡n cÃ³ muá»‘n má»Ÿ trang TutorRevenueStable Ä‘á»ƒ test ngay khÃ´ng?")
        ) {
          window.open(
            "http://localhost:3000/user/tutor-revenue-stable",
            "_blank"
          );
        }
      }, 3000);
    </script>
  </body>
</html>
